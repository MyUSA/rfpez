// Generated by CoffeeScript 1.3.3
(function() {
  var keep_bid_in_view, move_selection, select_bid, select_this_bid;

  keep_bid_in_view = function(bid, scrollTo) {
    var bottom, current_bottom, current_top, top;
    $(document).off("mouseover.selectbidmouseover");
    if (scrollTo === "bid") {
      bottom = bid.offset().top + bid.height();
      current_bottom = $(window).scrollTop() + $(window).height();
      top = bid.offset().top;
      current_top = $(window).scrollTop();
      if (current_bottom < bottom) {
        $('html, body').scrollTop(bottom - $(window).height());
      }
      if (current_top > top) {
        $('html, body').scrollTop(bid.offset().top);
      }
    } else if (scrollTo === "top") {
      $('html, body').scrollTop(0);
    }
    return setTimeout(function() {
      return $(document).on("mouseover.selectbidmouseover", ".bid", select_this_bid);
    }, 200);
  };

  select_bid = function(bid, scrollTo) {
    $(".bid").removeClass('selected');
    bid.addClass('selected');
    if (scrollTo) {
      return keep_bid_in_view(bid, scrollTo);
    }
  };

  select_this_bid = function() {
    return select_bid($(this), false);
  };

  move_selection = function(direction) {
    var all_bids, new_index, new_selection, selected_bid, selected_index;
    selected_bid = $(".bid.selected:eq(0)");
    if (!selected_bid) {
      return;
    }
    all_bids = $(".bid");
    selected_index = all_bids.index(selected_bid);
    if (direction === "up") {
      if (selected_index === 0) {
        return select_bid(selected_bid, "top");
      }
      new_index = selected_index - 1;
    } else {
      new_index = selected_index + 1;
    }
    new_selection = $(".bid:eq(" + new_index + ")");
    if (new_selection.length > 0) {
      return select_bid(new_selection, "bid");
    }
  };

  $(document).bind('keydown', 'i', function() {
    return move_selection("up");
  });

  $(document).bind('keydown', 'k', function() {
    return move_selection("down");
  });

  $(document).on("mouseover.selectbidmouseover", ".bid", select_this_bid);

}).call(this);
